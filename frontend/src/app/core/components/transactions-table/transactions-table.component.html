<div class="example-container mat-elevation-z8">
  @if (isLoadingResults) {
    <div class="example-loading-shade">
      <mat-spinner></mat-spinner>
    </div>
  }

  <div class="example-table-container">
    <table mat-table [dataSource]="data" class="example-table"
           matSort matSortActive="date" matSortDisableClear matSortDirection="desc">
      <!-- Date Column -->
      <ng-container matColumnDef="date">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="date">Date</th>
        <td mat-cell *matCellDef="let transaction">{{transaction.date | date:'medium'}}</td>
      </ng-container>

      <!-- Account Column -->
      <ng-container matColumnDef="account">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="account">Account</th>
        <td mat-cell *matCellDef="let transaction">{{transaction.account.accountNumber}}</td>
      </ng-container>

      <!-- Recipient IBAN Column -->
      <ng-container matColumnDef="recipientIBAN">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="recipientIBAN">Recipient IBAN</th>
        <td mat-cell *matCellDef="let transaction">{{transaction.recipientIBAN}}</td>
      </ng-container>

      <!-- Description Column -->
      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="description">Description</th>
        <td mat-cell *matCellDef="let transaction">{{transaction.description}}</td>
      </ng-container>

      <!-- Amount Column -->
      <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="amount">Amount</th>
        <td mat-cell *matCellDef="let transaction">{{transaction.amount | number:'1.2-2'}} {{transaction.account.currency}}</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;" 
          (click)="openTransactionDialog(row)" 
          style="cursor: pointer;"
          [ngClass]="{
            'flagged-row': row.flagged,
            'flagged-pending': row.flagged && row.flagged?.status === 'pending' && !filters.showOnlyFlagged,
            'flagged-resolved': row.flagged && row.flagged?.status === 'resolved' && !filters.showOnlyFlagged,
            'flagged-dismissed': row.flagged && row.flagged?.status === 'dismissed' && !filters.showOnlyFlagged
          }">
      </tr>

      <!-- Row shown when there is no matching data. -->
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="5">No data available</td>
      </tr>
    </table>
  </div>

  <mat-paginator [length]="resultsLength" [pageSize]="10" aria-label="Select page"></mat-paginator>
</div>
